*
* Simple test of IDEA encryption/decryption function!
*
DIM EK(52), DK(52), T(3, 12), DTA(8), PLAIN(8)
*
T(1,1)="00010002000300040005000600070008"; T(2,1)="0000000100020003"; T(3,1)="11FBED2B01986DE5"
T(1,2)="0005000A000F00140019001E00230028"; T(2,2)="0102030405060708"; T(3,2)="3EC04780BEFF6E20"
T(1,3)="3A984E2000195DB32EE501C8C47CEA60"; T(2,3)="0102030405060708"; T(3,3)="97BCD8200780DA86"
T(1,4)="006400C8012C019001F4025802BC0320"; T(2,4)="05320A6414C819FA"; T(3,4)="65BE87E7A2538AED"
T(1,5)="9D4075C103BC322AFB03E7BE6AB30006"; T(2,5)="0808080808080808"; T(3,5)="F5DB1AC45E5EF9F9"
T(1,6)="00010002000300040005000600070008"; T(2,6)="0102030405060708"; T(3,6)="540E5FEA18C2F8B1"
T(1,7)="00010002000300040005000600070008"; T(2,7)="0019324B647D96AF"; T(3,7)="9F0A0AB6E10CED78"
T(1,8)="00010002000300040005000600070008"; T(2,8)="F5202D5B9C671B08"; T(3,8)="CF18FD7355E2C5C5"
T(1,9)="00010002000300040005000600070008"; T(2,9)="FAE6D2BEAA96826E"; T(3,9)="85DF52005608193D"
T(1,10)="00010002000300040005000600070008";T(2,10)="0A141E28323C4650";T(3,10)="2F7DE750212FB734"
T(1,11)="00010002000300040005000600070008";T(2,11)="050A0F14191E2328";T(3,11)="7B7314925DE59C09"
T(1,12)="0005000A000F00140019001E00230028";T(2,12)="0102030405060708";T(3,12)="3EC04780BEFF6E20"
*
MAT DTA = 0
FOR TP = 1 TO 12
   SVAL = T(1, TP)
   CALL IDEA(1, SVAL, MAT DTA, MAT EK)
   *
   CALL IDEA(2, SVAL, MAT DTA, MAT DK)
   *
   FOR I = 1 TO 8
      PLAIN(I) = OCONV(T(2, TP)[I*2-1, 2], 'MCXD')
   NEXT I
   *
   MAT DTA = MAT PLAIN 
   CALL IDEA(3, SVAL, MAT DTA, MAT EK)
   *
   ERR = 0
   FOR I = 1 TO 8 UNTIL ERR
      ERR = DTA(I) # OCONV(T(3, TP)[I*2-1, 2], 'MCXD')
   NEXT I
   IF ERR THEN
      EVAL = ''
      FOR I = 1 TO 8
         EVAL = EVAL:OCONV(DTA(I), 'MCDX') "R%2"
      NEXT I
      CRT TP:' - Encryption failed! - expected: ':T(3,TP):' - got: ':EVAL
      STOP
   END
   *
   CALL IDEA(3, SVAL, MAT DTA, MAT DK)
   ERR = 0
   FOR I = 1 TO 8 UNTIL ERR
      ERR = (PLAIN(I) # DTA(I))
   NEXT I
   IF ERR THEN
      CRT 'Non-reversed encryption! - error!'
      STOP
   END
NEXT TP
*
CRT 'IDEA encryption/decryption ok!'
*
END
